<!-- This uses pupetter a headless browser tto generate the model on a canvas which will be used 
 by node code to take a screenshot for automated thumbnails -->


<!-- more reliable for pupeteer since it doesn't use modules or affect ES6 modules -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Preview</title>
</head>
<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  
  <script>
 
    const scene = new THREE.Scene(); // create canvas
    const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000); // create camera
    const renderer = new THREE.WebGLRenderer({ antialias: true }); // create renderer
    renderer.setSize(512, 512); // set size
    renderer.setClearColor("white"); // set background color
    document.body.appendChild(renderer.domElement); // add renderer to dom

    // LIGTHING
    // Added ambient light for base illumination
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6); // Soft white light
    scene.add(ambientLight);
    // Added a directional light for highlights and shading
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(5, 10, 7.5);
    scene.add(directionalLight);
  
    
    const params = new URLSearchParams(window.location.search); // get query params
    const modelUrl = params.get('model'); // get model url
    const loader = new THREE.GLTFLoader(); // create loader
    console.log('Trying to load model:', modelUrl);
    loader.load(modelUrl, (gltf) => {
      //model position
      gltf.scene.position.set(0, 0, 0);// set model position
      scene.add(gltf.scene);
      camera.position.z = 2;// set camera position
      renderer.render(scene, camera);
      window.modelRendered = true;// signal to puppeteer that the model has been rendered
    });
    console.log('Model rendered:', window.modelRendered, modelUrl);
  </script>
</body>
</html>
